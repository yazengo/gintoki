<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
  <HTML>
    <HEAD>
      <TITLE>Presentation page for Controlling Muno</TITLE>
    </HEAD>

    <BODY>

      <H3><P ID=FName>Device Name</P></H3>


      <H3>Muno Device Control State Table</H3>
      <TABLE BGCOLOR='#D6D7DE' BORDER=0 VALIGN=top ALIGN=left CELLPADDING=1 CELLSPACING=3>
        <TR>
          <TD BGCOLOR='#000000' VALIGN=center ALIGN=center WIDTH=60><B><FONT SIZE="2" COLOR=whitesmoke>Variable</FONT></B></TD>
          <TD VALIGN=middle ALIGN=left BGCOLOR='#000000' WIDTH=60><B><FONT SIZE="2" COLOR=whitesmoke>Value</FONT></B></TD>
          <TD VALIGN=middle ALIGN=left BGCOLOR='#000000' WIDTH=60><B><FONT SIZE="2" COLOR=whitesmoke>Actions</FONT></B></TD>
        </TR>

        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>PAUSE</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><P ID=Volume></P></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerPause()"     value="PAUSE">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>NEXT</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><P ID=Volume></P></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerNext()"     value="NEXT">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>V+</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><P ID=Volume></P></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerVup()"     value="V+">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>V-</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><P ID=Volume></P></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerVdown()"     value="V-">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>GOTO</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><INPUT type="text"      value="33"  ID=MusicID></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerGoto()"     value="GOTO">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>PLAYLIST</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><INPUT type="text"      value="33"  ID=MusicList></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerPlaylist()"     value="PLAY">
          </TD>
        </TR>
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>FW UPDATE</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerFWupdate()"     value="FW UPDATE">
          </TD>
        </TR>
        
        
        <TR>
          <TD  BGCOLOR="#FFFFFF" VALIGN=center ALIGN=center>SETLED</TD>
          <TD  BGCOLOR="#FFFFFF" valign="top"><INPUT type="text"      value="33"  ID=RGBVal></TD>
          <TD  BGCOLOR="#FFFFFF" valign="top">
		&nbsp;&nbsp;
		<INPUT type="button" onclick="SetPlayerLight()"     value="SETLED">
          </TD>
        </TR>
      </TABLE>


      <BR>
      <BR>
      <BR>
      <BR>
      <BR>
      <BR>
      <BR>
      <BR>
      <BR>

<SCRIPT language=VBScript>


' *********************************************************
' Event handler called when the UPnP device submits events
' *********************************************************



Sub eventHandler(callbackType, svcObj, varName, value)

'Dim output
'output = output & "varName " & varName & vbCrLf 
'output = output & "value " & value & vbCrLf
'output = output & "svcObj " & svcObj.Id & vbCrLf
'MsgBox output 

  If (callbackType = "VARIABLE_UPDATE") Then
    select case svcObj.Id
      case "urn:upnp-org:serviceId:tvcontrol1"
        select case varName
          Case "Power"      Power.innerText = value
          Case "Channel"    Channel.innerText = value
          Case "Volume"     Volume.innerText = value
        end select
      case "urn:upnp-org:serviceId:tvpicture1"
        select case varName
          Case "Color"      Color.innerText = value
          Case "Tint"       Tint.innerText = value
          Case "Contrast"   Contrast.innerText = value
          Case "Brightness" Brightness.innerText = value
        end select
      end select
    End If
End Sub



' **********************************************************
' Button action callbacks invoke actions
' **********************************************************

function SetPlayerPause()
    Dim inArgs(0)
    Dim outArgs(0)
    TvControlService.InvokeAction "PlayerPause", inArgs, outArgs
end function

function SetPlayerNext()
    Dim inArgs(0)
    Dim outArgs(0)
    TvControlService.InvokeAction "PlayerNext", inArgs, outArgs
end function

function SetPlayerVup()
    Dim inArgs(0)
    Dim outArgs(0)
    TvControlService.InvokeAction "PlayerVolumeup", inArgs, outArgs
end function

function SetPlayerVdown()
    Dim inArgs(0)
    Dim outArgs(0)
    TvControlService.InvokeAction "PlayerVolumedown", inArgs, outArgs
end function

function SetPlayerGoto()
    Dim inArgs(1)
    Dim outArgs(0)
    inArgs(0) = MusicID.value
    TvControlService.InvokeAction "PlayerGoto", inArgs, outArgs
end function

function SetPlayerPlaylist()
    Dim inArgs(1)
    Dim outArgs(0)
    inArgs(0) = MusicList.value
    TvControlService.InvokeAction "PlayerPlaylist", inArgs, outArgs
end function

function SetPlayerFWupdate()
    Dim inArgs(0)
    Dim outArgs(0)
    TvControlService.InvokeAction "PlayerFWdownload", inArgs, outArgs
end function

function SetPlayerLight()
    Dim inArgs(1)
    Dim outArgs(0)
    inArgs(0) = RGBVal.value
    TvControlService.InvokeAction "PlayerLightSetting", inArgs, outArgs
end function


' ********************************************************
' Download the description document from the UPnP device
' ********************************************************
Dim TvDesc
Set TvDesc = CreateObject("UPnP.DescriptionDocument.1")
TvDesc.Load("munodevicedesc.xml")


' ********************************************************
' Get the Root Device from the description document
' ********************************************************
Dim TvDevice
Set TvDevice = TvDesc.RootDevice


' ********************************************************
' Output some of the device properties to the user
' ********************************************************
Dim output
output = "Found: " & vbCrLf
output = output & "DisplayName: " & TvDevice.FriendlyName & vbCrLf 
output = output & "Type: " & TvDevice.Type & vbCrLf
output = output & "UDN: " & TvDevice.UniqueDeviceName & vbCrLf
MsgBox output 

FName.innerText =  TvDevice.FriendlyName


' ********************************************************
' Attach the event handler to the tv control service 
' ********************************************************
Dim TvControlService
set TvControlService=TvDevice.Services("urn:upnp-org:serviceId:munocontrol1")
TvControlService.AddCallback GetRef("eventHandler")

</SCRIPT>
</BODY>
</HTML>





